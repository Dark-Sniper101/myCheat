const L = ("inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 13\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 0\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 11\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 3\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 14\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 8\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x -5\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 5\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 14\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 13\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 10\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 9\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 12\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 6\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x -14\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 1\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x -8\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 1\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 1\n" +
    "add x 13\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 2\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x 0\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 7\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x -5\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 5\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x -9\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 8\n" +
    "mul y x\n" +
    "add z y\n" +
    "inp w\n" +
    "mul x 0\n" +
    "add x z\n" +
    "mod x 26\n" +
    "div z 26\n" +
    "add x -1\n" +
    "eql x w\n" +
    "eql x 0\n" +
    "mul y 0\n" +
    "add y 25\n" +
    "mul y x\n" +
    "add y 1\n" +
    "mul z y\n" +
    "mul y 0\n" +
    "add y w\n" +
    "add y 15\n" +
    "mul y x\n" +
    "add z y").split("\n");


IN = "27141191213911";

function setup() {
    frameRate(60);
    createCanvas(1330, 500);
}

let N = 500;

function textyellow() {
    stroke('rgb(250,205,93)');
    fill('rgb(250,205,93)');
}

function textblue() {
    stroke('lightblue');
    fill('lightblue');
}

function textpurple() {
    stroke('#9e72e3');
    fill('#9E72E3FF');
}

let CURRENT = 0
let K = 0
let TOP = 500
let W = 0, X = 0, Y = 0, Z = 0

let done = new Set();
let registry = {w: 0, x: 0, y: 0, z: 0, pos: 0}
let P = 0

let S = L.map((e, i) => {
    let [cmd, a, b] = e.split(' ')
    //if (i % 18 === 0) registry = {w: 0, x: 0, y: 0, z: 0}

    if (cmd == "inp") {
        registry["w"] = parseInt(IN[P]);
        registry["pos"]++;
        P++
    } else if (cmd == "add") {
        let v = (['w', 'x', 'y', 'z'].includes(b))
        registry[a] += v ? registry[b] : parseInt(b)
    } else if (cmd == "mul") {
        let v = (['w', 'x', 'y', 'z'].includes(b))
        registry[a] *= v ? registry[b] : parseInt(b)
    } else if (cmd == "div") {
        let v = (['w', 'x', 'y', 'z'].includes(b))
        registry[a] /= v ? registry[b] : parseInt(b)
        registry[a] = Math.floor(registry[a])
    } else if (cmd == "mod") {
        let v = (['w', 'x', 'y', 'z'].includes(b))
        registry[a] %= v ? registry[b] : parseInt(b)
    } else if (cmd == "eql") {
        let v = (['w', 'x', 'y', 'z'].includes(b))
        registry[a] = registry[a] == (v ? registry[b] : parseInt(b)) ? 1 : 0
    }
    console.log(cmd, a, b, {...registry})

    return {...registry}
})

function draw() {
    background("#10101a");

    textyellow();
    textSize(20);
    textFont('Consolas');
    strokeWeight(0.5)

    let X = min(CURRENT, S.length - 1)

    fill("white")
    stroke("white")
    text("Submarine Number: ", 10, 25)

    if (X == S.length -1) {
        textyellow()
        text(IN + " VALID", textWidth("Submarine Number: ") + 10, 25)
    } else {
        textyellow()
        rect(textWidth("Submarine Number: ") + textWidth(" ".repeat(S[X].pos)), 35, textWidth(" "), 5)

        fill("cyan")
        stroke("cyan")
        text(IN, textWidth("Submarine Number: ") + 10, 25)
        fill("white")
        stroke("white")

        text("W: " + S[X].w, 500, 25)
        text("X: " + S[X].x, 600, 25)
        text("Y: " + S[X].y, 700, 25)
        text("Z: " + S[X].z, 800, 25)
    }

    for (let i = 0; i < L.length; ++i) {
        if (i === CURRENT) {
            textyellow()
        } else {
            let y = (i % 18)
            if (y === 4 || y === 5 || y === 15) textpurple()
            else textblue()
        }
        text(L[i].replace(/mul/, '*').replace(/add/, '+').replace(/div/, '/').replace(/mod/, '%').replace(/eql/, '='), 10 + floor(i / 18) * 95, 60 + (i % 18) * 25)
    }
    if (K++ > 1) {
        K = 0
        CURRENT++
    }
}